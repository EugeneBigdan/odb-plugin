define(["@grafana/data","@grafana/runtime","rxjs","react","@grafana/ui"],((e,t,r,n,o)=>(()=>{"use strict";var a={781:t=>{t.exports=e},531:e=>{e.exports=t},7:e=>{e.exports=o},959:e=>{e.exports=n},269:e=>{e.exports=r}},l={};function i(e){var t=l[e];if(void 0!==t)return t.exports;var r=l[e]={exports:{}};return a[e](r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};return(()=>{i.r(u),i.d(u,{plugin:()=>b});var e=i(781),t=i(531),r=i(269);function n(e,r){let n=e;return n.includes("$__from")&&(n=n.replace(/\$__from/g,"TO_TIMESTAMP('1970-01-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS') + NUMTODSINTERVAL($__from / 1000, 'SECOND')")),n.includes("$__to")&&(n=n.replace(/\$__to/g,"TO_TIMESTAMP('1970-01-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS') + NUMTODSINTERVAL($__to / 1000, 'SECOND')")),(0,t.getTemplateSrv)().replace(n,r)}function o(e,t,r,n,o,a,l){try{var i=e[a](l),u=i.value}catch(e){return void r(e)}i.done?t(u):Promise.resolve(u).then(n,o)}class a extends t.DataSourceWithBackend{query(e){for(const t of e.targets)e.scopedVars&&Object.keys(e.scopedVars).length>0&&(t.o_parsed=n(t.o_sql||"",e.scopedVars));return super.query(e)}metricFindQuery(t,n){var a,l=this;return(a=function*(){if(!t)return Promise.resolve([]);const n=l.query({interval:"",intervalMs:0,requestId:"metricFindQuery",range:{from:(0,e.dateTime)(),to:(0,e.dateTime)(),raw:{from:(0,e.dateTime)(),to:(0,e.dateTime)()}},scopedVars:{},targets:[{datasource:l.getDefaultQuery(e.CoreApp.Unknown).datasource,o_parsed:t,refId:"A"}],timezone:"Z",app:"",startTime:0});return(0,r.lastValueFrom)(n.pipe((0,r.switchMap)((e=>e.data)),(0,r.switchMap)((e=>e.fields)),(0,r.map)((e=>e.values.toArray().map((e=>({text:e})))))))},function(){var e=this,t=arguments;return new Promise((function(r,n){var l=a.apply(e,t);function i(e){o(l,r,n,i,u,"next",e)}function u(e){o(l,r,n,i,u,"throw",e)}i(void 0)}))})()}getDefaultQuery(e){return{o_sql:"SELECT * \n FROM SYS.races \nWHERE data BETWEEN $__from AND $__to"}}constructor(e){super(e)}}var l=i(959),s=i.n(l),c=i(7);function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){p(e,t,r[t])}))}return e}function v(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const b=new e.DataSourcePlugin(a).setConfigEditor((function(e){const{onOptionsChange:t,options:r}=e,{jsonData:n,secureJsonFields:o}=r,a=r.secureJsonData||{};return s().createElement(c.VerticalGroup,null,s().createElement(c.Legend,null,"Authentication"),s().createElement(c.HorizontalGroup,null,s().createElement(c.InlineField,{grow:!0,label:"User",labelWidth:12},s().createElement(c.Input,{placeholder:"oracle_user",required:!0,value:n.o_user,width:40,onChange:e=>{t(v(d({},r),{jsonData:v(d({},r.jsonData),{o_user:e.target.value})}))},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})),s().createElement(c.InlineField,{grow:!0,label:"Password",labelWidth:12},s().createElement(c.SecretInput,{isConfigured:o&&o.o_password,placeholder:"oracle_password",required:!0,value:a.o_password,width:40,onChange:e=>{t(v(d({},r),{secureJsonData:{o_password:e.target.value}}))},onReset:()=>{t(v(d({},r),{secureJsonFields:v(d({},r.secureJsonFields),{o_password:!1}),secureJsonData:v(d({},r.secureJsonData),{o_password:""})}))},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}))),s().createElement(c.Legend,null,"Connection"),s().createElement(c.InlineField,{grow:!0,label:"ConnString",labelWidth:12},s().createElement(c.Input,{placeholder:"(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=localhost)(PORT=1521))(CONNECT_DATA=(SID=XE)))",value:n.o_connStr,width:94,onChange:e=>{t(v(d({},r),{jsonData:v(d({},r.jsonData),{o_connStr:e.target.value})}))},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})),s().createElement(c.HorizontalGroup,null,s().createElement(c.InlineField,{grow:!0,label:"Hostname",labelWidth:12},s().createElement(c.Input,{placeholder:"localhost",value:n.o_hostname,width:40,onChange:e=>{t(v(d({},r),{jsonData:v(d({},r.jsonData),{o_hostname:e.target.value})}))},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})),s().createElement(c.InlineField,{grow:!0,label:"Port",labelWidth:12},s().createElement(c.Input,{placeholder:"1521",type:"number",value:n.o_port,width:40,onChange:e=>{t(v(d({},r),{jsonData:v(d({},r.jsonData),{o_port:Number(e.target.value)})}))},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}))),s().createElement(c.HorizontalGroup,null,s().createElement(c.InlineField,{grow:!0,label:"Service",labelWidth:12},s().createElement(c.Input,{placeholder:"",value:n.o_service,width:40,onChange:e=>{t(v(d({},r),{jsonData:v(d({},r.jsonData),{o_service:e.target.value,o_sid:""})}))},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})),s().createElement(c.InlineField,{grow:!0,label:"or SID",labelWidth:12},s().createElement(c.Input,{placeholder:"XE",value:n.o_sid,width:40,onChange:e=>{t(v(d({},r),{jsonData:v(d({},r.jsonData),{o_service:"",o_sid:e.target.value})}))},onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}))))})).setQueryEditor((function({onChange:e,query:t}){var r;return s().createElement("div",{style:{alignItems:"stretch",display:"flex",flexFlow:"row wrap",justifyContent:"stretch",minHeight:"320px"}},s().createElement("div",{style:{flexGrow:1,minWidth:"480px",padding:"10px 5px"}},s().createElement(c.Label,{description:"Query to make on an Oracle database"},"Query"),s().createElement(c.TextArea,{onChange:r=>{var n,o;e((n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){f(e,t,r[t])}))}return e}({},t),o=null!=(o={o_sql:r.currentTarget.value})?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(o)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})),n))},placeholder:"SELECT * \\n FROM SYS.races \\nWHERE data BETWEEN $__from AND $__to",rows:12,value:t.o_sql,required:!0,width:"100%",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})),s().createElement("div",{style:{flexGrow:1,minWidth:"480px",padding:"10px 5px"}},s().createElement(c.Label,{description:"How the query will be executed on the database, using all the available variables"},"Parsed Query"),s().createElement(c.TextArea,{readOnly:!0,rows:12,value:n(null!==(r=t.o_sql)&&void 0!==r?r:""),width:"100%",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})))}))})(),u})()));
//# sourceMappingURL=module.js.map